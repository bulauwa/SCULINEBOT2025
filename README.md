# LINE 旅遊機器人 - 旅遊小管家 小花

這是一個基於 Flask 和 Google Gemini AI 的 LINE 聊天機器人，名為「旅遊小管家 小花」。它旨在成為使用者的智慧旅遊夥伴，協助他們探索世界、規劃行程、解答旅遊相關的各種問題，並提供圖片與影片的互動理解功能。

## 功能特色

*   **一站式旅遊規劃平台：** 整合行程建議、資訊查詢、歷史紀錄等多功能於一體。
*   **自然語言互動：** 透過自然的對話方式進行旅遊規劃與查詢。
*   **個性化建議：** 參考對話歷史，提供更貼近個人需求的建議。
*   **歷史紀錄查詢：** 方便使用者回顧與查找過去的規劃。

## 核心功能

使用者可以透過與「旅遊小管家 小花」的 LINE 聊天介面進行以下操作：

1.  **旅遊規劃 (Travel Planning):**
    *   **啟動方式:** 直接向機器人描述您的旅遊需求，例如：「我想去日本東京玩五天，預算三萬台幣，喜歡動漫和美食」。
    *   **功能:**
        *   根據使用者的興趣（例如：美食、文化、戶外活動）、預算（預設為新台幣）及地點，推薦合適的景點與餐廳。
        *   提供一日或多日的詳細行程建議，並能根據需求進行調整。
        *   協助查詢天氣、交通方式、飯店資訊及機票價格。
        *   回答有關簽證、當地習俗、緊急聯絡方式等問題。

2.  **新增規劃 (New Plan Creation):**
    *   **啟動方式:** 輸入 `我要新增規劃`。
    *   **功能:** 機器人會引導您提供旅遊國家地點、日期、人數、預算、住宿類型選擇、交通方式、想去的景點或餐廳等詳細資訊，以利進行更精準的規劃。

3.  **歷史紀錄查詢 (History Search):**
    *   **啟動方式:** 輸入 `我要瀏覽歷史紀錄`。
    *   **功能:**
        *   進入搜尋模式後，輸入國家、地點或相關關鍵字來查詢過去的旅遊規劃。
        *   系統會列出相關的行程摘要，並進行編號。
        *   輸入摘要的編號（例如：`1`）即可查看該筆規劃的完整內容。
        *   輸入 `全部顯示` 可一次查看所有搜尋到的摘要的完整內容（若摘要內容過多，建議逐筆查看）。
    *   **結束方式:** 輸入 `結束搜尋` 以退出歷史紀錄查詢模式。

4.  **多語言支援 (Multilingual Support):**
    *   主要互動語言為繁體中文。
    *   能自動偵測英文及日文，並在適當時機（如問候語）提供基本翻譯。

5.  **個性化建議 (Personalized Suggestions):**
    *   機器人會參考與使用者的對話歷史（如偏好的活動類型、曾去過的地點、預算範圍等）來提供更連貫且個人化的建議。
    *   若無相關歷史紀錄，則提供較通用的旅遊資訊，避免過多重複提問。

## 解決的問題

*   **資訊過載與篩選困難：** 協助使用者從大量旅遊資訊中快速找到所需內容。
*   **行程規劃耗時費力：** 提供初步行程框架，節省使用者從零開始規劃的時間。
*   **個人化需求難以滿足：** 透過對話歷史學習，提供更符合個人偏好的建議。
*   **即時疑問解答：** 快速回應旅遊相關的常見問題。

## 技術棧

*   **後端框架:** Flask
*   **LINE Bot SDK:** 
*   **AI 模型:** Google Gemini 
    *   `gemini-2.0-flash`: 用於旅遊規劃與圖片辨識。


## 未來發展方向

*   **進階 LINE 互動介面：** 整合 LINE 快速回覆 (Quick Reply)、圖文選單 (Rich Menu)、彈性訊息 (Flex Message) 以提升使用者體驗。
*   **更精細的個人化：** 引入更複雜的用戶偏好模型。
*   **主動提醒功能：** 例如，根據已規劃行程提供出發前提醒。
*   **多平台資訊整合：** 串接更多第三方服務（如即時匯率、航班動態等）。

## 注意事項

*   確保 LINE Bot 的 Webhook URL 設定正確，並指向您應用程式的 `/` 回呼路徑。
*   在 LINE Developer Console 中啟用 Webhook。
*   `SPACE_HOST` 環境變數對於圖片和影片訊息的正確顯示至關重要，請確保其指向可公開存取的服務位址。
*   本專案的 AI 回應品質與 Google Gemini 模型的能力及設定的指示 (System Instruction) 有關。
```# LINE 旅遊機器人 - 旅遊小管家 小花

這是一個基於 Flask 和 Google Gemini AI 的 LINE 聊天機器人，名為「旅遊小管家 小花」。它旨在成為使用者的智慧旅遊夥伴，協助他們探索世界、規劃行程、解答旅遊相關的各種問題，並提供圖片與影片的互動理解功能。

## 功能特色

*   **一站式旅遊規劃平台：** 整合行程建議、資訊查詢、歷史紀錄等多功能於一體。
*   **自然語言互動：** 透過自然的對話方式進行旅遊規劃與查詢。
*   **個性化建議：** 參考對話歷史，提供更貼近個人需求的建議。
*   **多媒體互動：** 支援圖片辨識（一般描述、面相/手相分析）與影片內容理解。
*   **歷史紀錄查詢：** 方便使用者回顧與查找過去的規劃。

## 核心功能

使用者可以透過與「旅遊小管家 小花」的 LINE 聊天介面進行以下操作：

1.  **旅遊規劃 (Travel Planning):**
    *   **啟動方式:** 直接向機器人描述您的旅遊需求，例如：「我想去日本東京玩五天，預算三萬台幣，喜歡動漫和美食」。
    *   **功能:**
        *   根據使用者的興趣（例如：美食、文化、戶外活動）、預算（預設為新台幣）及地點，推薦合適的景點與餐廳。
        *   提供一日或多日的詳細行程建議，並能根據需求進行調整。
        *   協助查詢天氣、交通方式、飯店資訊及機票價格。
        *   回答有關簽證、當地習俗、緊急聯絡方式等問題。

2.  **新增規劃 (New Plan Creation):**
    *   **啟動方式:** 輸入 `我要新增規劃`。
    *   **功能:** 機器人會引導您提供旅遊國家地點、日期、人數、預算、住宿類型選擇、交通方式、想去的景點或餐廳等詳細資訊，以利進行更精準的規劃。

3.  **歷史紀錄查詢 (History Search):**
    *   **啟動方式:** 輸入 `我要瀏覽歷史紀錄`。
    *   **功能:**
        *   進入搜尋模式後，輸入國家、地點或相關關鍵字來查詢過去的旅遊規劃。
        *   系統會列出相關的行程摘要，並進行編號。
        *   輸入摘要的編號（例如：`1`）即可查看該筆規劃的完整內容。
        *   輸入 `全部顯示` 可一次查看所有搜尋到的摘要的完整內容（若摘要內容過多，建議逐筆查看）。
    *   **結束方式:** 輸入 `結束搜尋` 以退出歷史紀錄查詢模式。

4.  **圖片互動 (Image Interaction):**
    *   **啟動方式:** 直接傳送圖片給機器人。
    *   **功能:**
        *   **面相/手相分析:** 若上傳清晰的手掌照片，機器人（扮演資深面相命理師角色）會嘗試解釋手相；若為正面臉部照片，則解釋面相。
        *   **一般圖片描述:** 對於其他類型的圖片，機器人會提供圖片內容的常規描述。

5.  **影片理解 (Video Understanding):**
    *   **啟動方式:** 直接傳送影片給機器人。
    *   **功能:** 機器人（扮演專業影片解說員角色）會提供影片內容的簡要說明，並回傳一個暫時的影片連結。

6.  **多語言支援 (Multilingual Support):**
    *   主要互動語言為繁體中文。
    *   能自動偵測英文及日文，並在適當時機（如問候語）提供基本翻譯。

7.  **個性化建議 (Personalized Suggestions):**
    *   機器人會參考與使用者的對話歷史（如偏好的活動類型、曾去過的地點、預算範圍等）來提供更連貫且個人化的建議。
    *   若無相關歷史紀錄，則提供較通用的旅遊資訊，避免過多重複提問。

## 解決的問題

*   **資訊過載與篩選困難：** 協助使用者從大量旅遊資訊中快速找到所需內容。
*   **行程規劃耗時費力：** 提供初步行程框架，節省使用者從零開始規劃的時間。
*   **個人化需求難以滿足：** 透過對話歷史學習，提供更符合個人偏好的建議。
*   **即時疑問解答：** 快速回應旅遊相關的常見問題。
*   **多媒體內容理解：** 擴展互動方式，不僅限於文字。

## 技術棧

*   **後端框架:** Flask
*   **LINE Bot SDK:** [`line-bot-sdk-python`](/c:/Users/DELL/Downloads/gemini.py)
*   **AI 模型:** Google Gemini (透過 [`google-generativeai`](/C:/Users/DELL/Downloads/gemini.py) 套件)
    *   `gemini-2.0-flash`: 用於旅遊規劃與圖片辨識。
    *   `gemini-2.5-flash-preview-05-20`: 用於影片內容理解。
*   **圖片處理:** Pillow (PIL)
*   **文字處理:** `markdown`, `beautifulsoup4`
*   **程式碼檔案:** [`gemini.py`](/c:/Users/DELL/Downloads/gemini.py)

## 設定與啟動

### 環境變數

在運行此專案前，請確保已設定以下環境變數：

*   `GOOGLE_API_KEY`: 您的 Google API 金鑰。
*   `YOUR_CHANNEL_SECRET`: 您的 LINE Channel Secret。
*   `YOUR_CHANNEL_ACCESS_TOKEN`: 您的 LINE Channel Access Token。
*   `SPACE_HOST`: 部署服務的主機名稱（例如 Hugging Face Space 的 URL，如 `your-space-name.hf.space`），用於產生圖片/影片的公開網址。若未設定，圖片/影片可能無法正確顯示。

### 本地運行 (範例)

1.  **安裝依賴:**
    ```bash
    pip install Flask line-bot-sdk-python google-generativeai Pillow markdown beautifulsoup4
    ```
2.  **設定環境變數:** (方法因作業系統而異，可使用 `.env` 檔案搭配 `python-dotenv` 或直接在終端設定)
3.  **啟動 Flask 應用:**
    ```bash
    python gemini.py
    ```
4.  **設定 Webhook:** 將 LINE Developer Console 中的 Webhook URL 指向您應用程式的公開網址 (例如，若使用 ngrok，則為 `https://your-ngrok-id.ngrok.io/`，注意路徑為 `/`)。

## 未來發展方向

*   **進階 LINE 互動介面：** 整合 LINE 快速回覆 (Quick Reply)、圖文選單 (Rich Menu)、彈性訊息 (Flex Message) 以提升使用者體驗。
*   **更精細的個人化：** 引入更複雜的用戶偏好模型。
*   **主動提醒功能：** 例如，根據已規劃行程提供出發前提醒。
*   **多平台資訊整合：** 串接更多第三方服務（如即時匯率、航班動態等）。

## 注意事項

*   確保 LINE Bot 的 Webhook URL 設定正確，並指向您應用程式的 `/` 回呼路徑。
*   在 LINE Developer Console 中啟用 Webhook。
*   `SPACE_HOST` 環境變數對於圖片和影片訊息的正確顯示至關重要，請確保其指向可公開存取的服務位址。
*   本專案的 AI 回應品質與 Google Gemini 模型的能力及設定的指示 (System Instruction) 有關。
